<div class="wrapper">
  <div class="table-wrapper">
    <app-progress-bar *ngIf="loading"></app-progress-bar>

    <div class="table-search-container">
      <button
        mat-raised-button
        class="app-button app-button-green"
        [routerLink]="['c']"
        [state]="{type: 'create'}"
      >
        <mat-icon>add</mat-icon>
        Thêm
      </button>

      <mat-form-field appearance="outline" floatLabel="always">
        <mat-label>Tìm kiếm</mat-label>
        <input
          type="search"
          matInput
          #input
          (input)="onSearch($event)"
          placeholder="Ví dụ: Bò vàng"
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>

    <div class="table-container">
      <table
        mat-table
        [dataSource]="dataTableSource"
        matSort
        (matSortChange)="onSort($event)"
      >
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>STT</th>
          <td mat-cell *matCellDef="let element; let i = index">
            {{
              this.paginator.pageIndex == 0
                ? i + 1
                : 1 + i + this.paginator.pageIndex * this.paginator.pageSize
            }}
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Tên</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="farmingTime">
          <th mat-header-cell *matHeaderCellDef>Thời gian nuôi</th>
          <td mat-cell *matCellDef="let element">{{ element.farmingTime }}</td>
        </ng-container>

        <ng-container *ngIf="true" matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef colspan="2"></th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              matTooltip="Cập nhật"
              (click)="$event.stopPropagation()"
              [routerLink]="['u', element._id]"
            >
              <mat-icon class="material-icons-outlined app-icon"
                >drive_file_rename_outline</mat-icon
              >
            </button>
            <button
              mat-icon-button
              matTooltip="Xoá"
              (click)="$event.stopPropagation(); onDelete(element)"
            >
              <mat-icon class="material-icons-outlined color-red app-icon"
                >delete_outline</mat-icon
              >
            </button>
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"
        ></tr>
        <tr
          mat-row
          *matRowDef="let element; columns: displayedColumns"
          class="app-element-row"
          [routerLink]="['d', element._id]"
        ></tr>
        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="6">
            Chưa có dữ liệu <strong>{{ input.value }}</strong>
          </td>
        </tr>
      </table>

      <mat-paginator
        [length]="totalCount"
        [pageSizeOptions]="[5, 10, 50, 100]"
        [pageSize]="defaultPageSize"
        (page)="onPagination($event)"
        aria-label="Select page"
        class="mat-paginator-sticky"
      ></mat-paginator>
    </div>
  </div>
</div>
